<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-commerce Application</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link rel="stylesheet" href="../public/css/show.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="css/starability-all.min.css"/>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');
/* Add a background color to the chat screen */
body {
    font-family: 'Roboto', sans-serif;
    background-size: cover;
    background-position: center center;
    font-smoothing: antialiased;
  }
  
  .logo-container
  {
    width: 100%;
    text-align: center;
  }

  .codingnexus {
    color: #fff;
    margin-top: 15px;
    font-size: 12px;
  }
  .codingnexus a {
    color: #fff;
    text-decoration: none;
  }

  #loading {
    font-size: 50px;
  }

  /* Style the chat box */
  .chat-box {
    margin: 0 auto;
    width: 600px;
    max-width: 100%;
    background-color: #ffffff;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    max-height: calc(100vh - 250px);
    height: calc(100vh - 250px);
  }

  .codingnexus {
    width: 100%;
    text-align: center;
  }
  
  /* Style the chat box header */
  .chat-box-header {
    background-color: #0084ff;
    color: #ffffff;
    padding: 16px;
    font-size: 20px;
    font-weight: bold;
    border-top-left-radius: 8px;
    border-top-right-radius: 8px;
  }
  
  /* Style the chat box body */
  .chat-box-body {
    padding: 16px;
    overflow-y: auto;
    height: calc(100% - 145px);
  }
  
  /* Style the chat messages */
  .chat-box-body .message,
  .chat-box-body .response {
    margin-bottom: 16px;
    padding: 8px 16px;
    border-radius: 8px;
  }
  
  /* Style the user's messages */
  .chat-box-body .message {
    background-color: #e6e6e6;
    color: #333333;
  }
  
  /* Style the chatbot's responses */
  .chat-box-body .response {
    background-color: #0084ff;
    color: #ffffff;
    text-align: right;
  }
  
  /* Style the chat box footer */
  .chat-box-footer {
    bottom: 0;
    display: flex;
    align-items: center;
    background-color: #ffffff;
    border-top: 1px solid #e6e6e6;
    padding: 8px 16px;
  }
  
  /* Style the input field */
  .chat-box-footer input[type="text"] {
    flex: 1;
    padding: 8px;
    border: 1px solid #e6e6e6;
    border-radius: 8px;
    font-size: 16px;
    outline: none;
  }
  
  /* Style the button */
  .chat-box-footer button {
    margin-left: 8px;
    padding: 8px 16px;
    background-color: #0084ff;
    color: #ffffff;
    font-size: 16px;
    font-weight: bold;
    border: none;
    border-radius: 8px;
    cursor: pointer;
  }
  
  /* Add some hover effects to the button */
  .chat-box-footer button:hover {
    background-color: #0073e6;
  }
  
  .chat-box-footer button:active {
    background-color: #005bbf;
  }
  
      li{
        height: fit-content !important;
        width: fit-content !important;
        font-size: 25px;
      }
    </style>    
</head>
<body style="background-color:#0d1b2a;">
  

    <%- include("../partials/navbar")  %>
    <%- include("../partials/flash")  %>

    <%- body -%>
    <div id="chat-container" style="border: 2px solid black;height:300px;width: 250px;background-color: white; position: absolute ; right:20px;bottom: 55px;">
      <div id="chat-messages" style="height: 268px;color: black;" >

      </div>
        <input type="text" id="user-message" placeholder="Type a message..." width="100%" />
        <button onclick="sendMessage()">Send</button>
    </div>
    <i id="open-chat-button" class="fa-solid fa-robot" style="font-size: 50px;color: #eb0000;position: absolute; right: 20px; bottom: 5px;"  onclick="toggleChat()"></i>
    

     <!-- <div class="chat-box">
      <div class="chat-box-header">JARVIS</div>
      <div class="chat-box-body">
        <div class="response">
          <p>Welcome to the Coding Nexus AI, how can I help you today?</p>
        </div>
      </div>
      <div class="chat-box-footer">
        <input type="text" placeholder="Ask a question..." />
        <button>Send</button>
      </div>
    </div> -->


    <!-- bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js" integrity="sha384-fbbOQedDUMZZ5KreZpsbe1LCZPVmfTnH7ois6mU1QK+m14rQ1l2bGBq41eYeM/fS" crossorigin="anonymous"></script>  
    <script src="/public/js/cartTemp.js"></script>
    <script>
      function toggleChat() {
        const chatContainer = document.getElementById('chat-container');
        chatContainer.style.display = chatContainer.style.display === 'none' ? 'block' : 'none';
      }
    
      function sendMessage() {
        // Implement sending messages and receiving bot responses here
      }
    </script>
    <script>
      function appendMessage(user, bot) {
        const chatMessages = document.getElementById('chat-messages');
        const messageDiv = document.createElement('div');
        messageDiv.className = 'message';
        messageDiv.innerHTML = `<span class="user-message">User: ${user}</span><br /><span class="bot-message">Bot: ${bot}</span>`;
        chatMessages.appendChild(messageDiv);
      }

      function sendMessage() { 
        const userMessage = document.getElementById('user-message').value;

        fetch('/chat/predict', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({userMessage }),
        })
          .then((response) => response.json())
          .then((data) => {
            const botResponse = data.botResponse;
            
            appendMessage(userMessage, botResponse);
          });

        document.getElementById('user-message').value = ''; 
      }
    </script>
    <!-- <script>
      const chatBox = document.querySelector(".chat-box");
const inputField = chatBox.querySelector("input[type='text']");
const button = chatBox.querySelector("button");
const chatBoxBody = chatBox.querySelector(".chat-box-body");

button.addEventListener("click", sendMessage);
inputField.addEventListener("keypress", function(event) {
  if (event.key === "Enter") {
    sendMessage();
  }
});

function sendMessage() {
  const message = inputField.value;
  inputField.value = "";
  chatBoxBody.innerHTML += `<div class="message"><p>${message}</p></div>`;
  chatBoxBody.innerHTML += `<div id="loading" class="response loading">.</div>`;
  scrollToBottom();
  window.dotsGoingUp = true;
    var dots = window.setInterval( function() {
        var wait = document.getElementById("loading");
        if ( window.dotsGoingUp ) 
            wait.innerHTML += ".";
        else {
            wait.innerHTML = wait.innerHTML.substring(1, wait.innerHTML.length);
        if ( wait.innerHTML.length < 2)
            window.dotsGoingUp = true;
        }
        if ( wait.innerHTML.length > 3 )
            window.dotsGoingUp = false;
        }, 250);

  fetch('/message', {
    method: 'POST',
    headers: {
      accept: 'application.json',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({message})
  }).then(response => {
    return response.json();
  }).then(data => {
    document.getElementById("loading").remove();
    chatBoxBody.innerHTML += `<div class="response"><p>${data.message}</p></div>`;
    scrollToBottom();
  })
}

function scrollToBottom() {
  chatBoxBody.scrollTop = chatBoxBody.scrollHeight;
}
    </script> -->
</body>
</html>